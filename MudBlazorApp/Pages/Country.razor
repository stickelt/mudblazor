@page "/country"
@page "/country/{Id:int}"
@using MudBlazor
@using MudBlazorApp.Models
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Web

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-4">
    @if (_showingDetails)
    {
        @if (_selectedCountry != null)
        {
            <MudPaper Class="pa-4">
                <MudText Typo="Typo.h4">@_selectedCountry.Name</MudText>
                <MudText>ID: @_selectedCountry.Id</MudText>
                <MudText>Verified: @(_selectedCountry.Verified ? "Yes" : "No")</MudText>
                <MudButton Class="mt-4" Variant="Variant.Filled" Color="Color.Primary" OnClick="@BackToList">Back to List</MudButton>
            </MudPaper>
        }
        else
        {
            <MudProgressCircular Indeterminate="true" />
        }
    }
    else
    {
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@AddNew" Class="mb-4">Add New</MudButton>
        
        <MudTable T="MudBlazorApp.Models.CountryModel" Items="@_countries" Hover="true">
            <HeaderContent>
                <MudTh>ID</MudTh>
                <MudTh>Name</MudTh>
                <MudTh>Verified</MudTh>
                <MudTh></MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Id">@context.Id</MudTd>
                <MudTd DataLabel="Name">@context.Name</MudTd>
                <MudTd DataLabel="Verified">@(context.Verified ? "Yes" : "No")</MudTd>
                <MudTd>
                    <MudLink Href="@($"/country/{context.Id}")" Color="Color.Primary">View Details</MudLink>
                </MudTd>
            </RowTemplate>
            <NoRecordsContent>
                <MudText>No countries found</MudText>
            </NoRecordsContent>
        </MudTable>
    }
</MudContainer>

<MudDialog Visible="_dialogVisible">
    <TitleContent>
        <MudText Typo="Typo.h6">Add New Country</MudText>
    </TitleContent>
    <DialogContent>
        <MudTextField T="string" @bind-Value="_newCountryName" Label="Country Name" Required="true" />
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="@CancelAddCountry">Cancel</MudButton>
        <MudButton Color="Color.Primary" OnClick="@SaveCountryAsync">OK</MudButton>
    </DialogActions>
</MudDialog>
